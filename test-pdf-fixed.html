<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Field Collaboration - Fixed Version</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #333;
            margin-bottom: 10px;
        }
        .status {
            background: #e8f5e8;
            border: 2px solid #4caf50;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .status.error {
            background: #ffeaea;
            border-color: #f44336;
        }
        .test-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .test-link {
            display: block;
            padding: 25px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            text-decoration: none;
            border-radius: 12px;
            text-align: center;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .test-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        .test-link.notary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .test-link.client {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        .instructions {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #007bff;
        }
        .instructions h3 {
            color: #007bff;
            margin-top: 0;
        }
        .instructions ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        .instructions li {
            margin: 8px 0;
        }
        .debug {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .debug h4 {
            color: #856404;
            margin-top: 0;
        }
        .debug pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîß PDF Field Collaboration - Fixed Version</h1>
            <p>–°–∏—Å—Ç–µ–º–∞ –∫–æ–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –∑ PDF –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏</p>
        </div>

        <div id="status" class="status">
            <h3>üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Å–µ—Ä–≤–µ—Ä—ñ–≤...</h3>
            <p>–ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —Å–µ—Ä–≤–µ—Ä—ñ–≤...</p>
        </div>

        <div class="instructions">
            <h3>üìã –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:</h3>
            <ol>
                <li><strong>–í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–≤—ñ –≤–∫–ª–∞–¥–∫–∏</strong> - –æ–¥–Ω—É –∑ Notary, –æ–¥–Ω—É –∑ Client</li>
                <li><strong>–£ –≤–∫–ª–∞–¥—Ü—ñ Notary:</strong> –ø–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å –ø–æ–ª—è –∑ —Ç—É–ª–±–∞—Ä–∞ —Å–ø—Ä–∞–≤–∞ –Ω–∞ PDF –¥–æ–∫—É–º–µ–Ω—Ç</li>
                <li><strong>–£ –≤–∫–ª–∞–¥—Ü—ñ Client:</strong> —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ –∑–∞ –∑–º—ñ–Ω–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ</li>
                <li><strong>–ü–µ—Ä–µ–º—ñ—â—É–π—Ç–µ –ø–æ–ª—è</strong> –º–∏—à–µ—é —Ç–∞ –∑–º—ñ–Ω—é–π—Ç–µ —ó—Ö —Ä–æ–∑–º—ñ—Ä –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫—É—Ç—ñ–≤</li>
                <li><strong>–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Approve"</strong> –≤ –æ–±–æ—Ö –≤–∫–ª–∞–¥–∫–∞—Ö</li>
                <li><strong>–ï–∫—Å–ø–æ—Ä—Ç—É–π—Ç–µ —à–∞–±–ª–æ–Ω</strong> –ø—ñ—Å–ª—è –ø–æ–≥–æ–¥–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö —É—á–∞—Å–Ω–∏–∫—ñ–≤</li>
            </ol>
        </div>

        <div class="test-links">
            <a href="http://localhost:5173/test-notary" class="test-link notary" target="_blank">
                <h3>üìù Notary (PDF Editor)</h3>
                <p>–ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –ø–æ–ª—ñ–≤</p>
                <small>–ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å –ø–æ–ª—è –∑ —Ç—É–ª–±–∞—Ä–∞ –Ω–∞ PDF</small>
            </a>
            
            <a href="http://localhost:5173/test-client" class="test-link client" target="_blank">
                <h3>üëÅÔ∏è Client (PDF Viewer)</h3>
                <p>–¢—ñ–ª—å–∫–∏ –ø–µ—Ä–µ–≥–ª—è–¥ –∑ —Ä–µ–∞–ª—Ç–∞–π–º —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—î—é</p>
                <small>–°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ –∑–∞ –∑–º—ñ–Ω–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ</small>
            </a>
            
            <a href="http://localhost:5173" class="test-link" target="_blank">
                <h3>üè† –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞</h3>
                <p>–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É</p>
                <small>–ü–æ–≤–Ω–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –∑ –≤—ñ–¥–µ–æ</small>
            </a>
        </div>

        <div class="debug">
            <h4>üêõ –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º:</h4>
            <ul>
                <li><strong>–ü–æ–ª—è –Ω–µ –ø–µ—Ä–µ—Ç—è–≥—É—é—Ç—å—Å—è:</strong> –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –Ω–∞ –ø–æ–º–∏–ª–∫–∏</li>
                <li><strong>–°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –Ω–µ –ø—Ä–∞—Ü—é—î:</strong> –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å WebSocket –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤–Ω–∏–∑—É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É</li>
                <li><strong>PDF –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è:</strong> –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —á–∏ —Ñ–∞–π–ª sample.pdf —ñ—Å–Ω—É—î –≤ public/</li>
                <li><strong>–°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω–∏–π:</strong> –ó–∞–ø—É—Å—Ç—ñ—Ç—å <code>cd server && npm run dev</code></li>
                <li><strong>–ö–ª—ñ—î–Ω—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω–∏–π:</strong> –ó–∞–ø—É—Å—Ç—ñ—Ç—å <code>cd client && npm run dev</code></li>
            </ul>
        </div>

        <div class="debug">
            <h4>üìä –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä—ñ–≤:</h4>
            <pre id="server-status">–ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ...</pre>
        </div>
    </div>

    <script>
        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Å–µ—Ä–≤–µ—Ä—ñ–≤
        async function checkServerStatus() {
            const statusDiv = document.getElementById('status');
            const statusPre = document.getElementById('server-status');
            let status = '';

            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ HTTP API
            try {
                const response = await fetch('http://localhost:4000/api/health');
                if (response.ok) {
                    const data = await response.json();
                    status += '‚úÖ HTTP API —Å–µ—Ä–≤–µ—Ä –ø—Ä–∞—Ü—é—î\n';
                    status += `   –°—Ç–∞—Ç—É—Å: ${data.status}\n`;
                    status += `   –ß–∞—Å: ${data.timestamp}\n\n`;
                } else {
                    status += '‚ùå HTTP API —Å–µ—Ä–≤–µ—Ä –Ω–µ –ø—Ä–∞—Ü—é—î\n\n';
                }
            } catch (error) {
                status += '‚ùå HTTP API —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π\n';
                status += `   –ü–æ–º–∏–ª–∫–∞: ${error.message}\n\n`;
            }

            // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ WebSocket
            try {
                const ws = new WebSocket('ws://localhost:1234');
                ws.onopen = () => {
                    status += '‚úÖ WebSocket —Å–µ—Ä–≤–µ—Ä –ø—Ä–∞—Ü—é—î\n';
                    status += '   –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ\n\n';
                    ws.close();
                    updateStatus();
                };
                ws.onerror = () => {
                    status += '‚ùå WebSocket —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π\n\n';
                    updateStatus();
                };
            } catch (error) {
                status += '‚ùå WebSocket —Å–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π\n';
                status += `   –ü–æ–º–∏–ª–∫–∞: ${error.message}\n\n`;
            }

            function updateStatus() {
                statusPre.textContent = status;
                
                if (status.includes('‚ùå')) {
                    statusDiv.className = 'status error';
                    statusDiv.innerHTML = '<h3>‚ùå –ü—Ä–æ–±–ª–µ–º–∏ –∑ —Å–µ—Ä–≤–µ—Ä–∞–º–∏</h3><p>–î–µ—è–∫—ñ —Å–µ—Ä–≤–µ—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–µ—Ç–∞–ª—ñ –Ω–∏–∂—á–µ.</p>';
                } else {
                    statusDiv.className = 'status';
                    statusDiv.innerHTML = '<h3>‚úÖ –í—Å—ñ —Å–µ—Ä–≤–µ—Ä–∏ –ø—Ä–∞—Ü—é—é—Ç—å</h3><p>–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è!</p>';
                }
            }
        }

        // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        checkServerStatus();

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É –∫–æ–∂–Ω—ñ 10 —Å–µ–∫—É–Ω–¥
        setInterval(checkServerStatus, 10000);
    </script>
</body>
</html>
